(function(a){var b=kendo.ui.Grid.fn.editCell;var c=kendo.ui.Grid.fn.init;kendo.ui.Grid=kendo.ui.Grid.extend({init:function(){c.apply(this,arguments);if(typeof this.options.beforeEdit==="function"){this.bind("beforeEdit",this.options.beforeEdit.bind(this))}},editCell:function(d){var i=this,g=a(d),e=i.columns[i.cellIndex(g)],h=i._modelForContainer(g),f={container:g,model:h,field:e.field};if(h&&this.trigger("beforeEdit",f)){if(f.isDefaultPrevented()){return}}b.call(this,d)}});kendo.ui.plugin(kendo.ui.Grid)})(jQuery);var NutcacheGridFunctions={nutcacheGrid_OnDataBound:function(b){NutcacheGridFunctions.initNutcacheGridMenus(this);NutcacheGridFunctions.setNoDataMinHeight(this);var c=this.element.attr("data-nutcache-onrecordselected");if(c!==undefined){NutcacheGridFunctions.addHoverStylingToGrid(this);NutcacheGridFunctions.addClickActionToGrid(this,c)}this.tbody.find("tr.k-grouping-row").click(function(d){if(NutcacheGridFunctions.isClickOnRowAllowed(d)){var e=$(this).find("a.k-i-collapse,a.k-i-expand");e.click()}});var a=this.element.attr("data-nutcache-databound");if(a!==undefined){executeFunctionByName(a,window,this)}},nutcacheEditableGrid_OnDataBound:function(a){if(!a.sender.dataSource.view().length){var b='<tr><td style="height: 70px; border-style: none"></td></tr>';a.sender.tbody.html(b)}},initNutcacheGridMenus:function(kendoGrid){kendoGrid.element.find(".grid-actions").each(function(){eval($(this).children("script").last().html())});var filter=kendoGrid.dataSource.filter();kendoGrid.thead.find(".k-header-column-menu.k-state-active").removeClass("k-state-active");if(filter){var filteredMembers={};NutcacheGridFunctions.setFilteredMembers(filter,filteredMembers);kendoGrid.thead.find("th[data-field]").each(function(){var cell=$(this);var filtered=filteredMembers[cell.data("field")];if(filtered){cell.find(".k-header-column-menu").addClass("k-state-active")}})}},setFilteredMembers:function(a,c){if(a.filters){for(var b=0;b<a.filters.length;b++){NutcacheGridFunctions.setFilteredMembers(a.filters[b],c)}}else{c[a.field]=true}},addHoverStylingToGrid:function(a){a.tbody.find("tr.k-alt").removeClass("k-alt");a.tbody.find("tr").hover(function(){$(this).addClass("k-state-hover")},function(){$(this).removeClass("k-state-hover")})},addClickActionToGrid:function(a,b){a.tbody.find("tr:not(.k-grouping-row)").click(function(c){if(NutcacheGridFunctions.isClickOnRowAllowed(c)){var d=a.dataItem(this);executeFunctionByName(b,window,d,c)}})},isClickOnRowAllowed:function(a){var b=$(a.target);return(a.ctrlKey||a.metaKey||!getSelection().toString())&&a.target.tagName.toLowerCase()!="a"&&b.parents("a").length==0&&b.parents(".k-menu").length==0&&!b.hasClass("nutcache-action-menu")},menuActionSaveConfig:function(a){NutcacheGridFunctions.saveConfig("#"+a.config.elementName,a.menuData.messages.configurationSaveConfirmMessage)},saveConfig:function(a,c){var b=$(a).data("kendoGrid");localStorage[a+"-options"]=kendo.stringify(b.getOptions());ShowSuccessMessages(c)},loadConfig:function(b){var d=$(b).data("kendoGrid");var s=$(b).find(".k-grid-toolbar").html();var c=b.id==undefined?b:"#"+b.id;var r=localStorage[c+"-options"];var a=d.getOptions();var m={};var f=true;if(r){var q=JSON.parse(r);m.columns=a.columns;m.dataSource={};if(q.dataSource!=undefined){if(q.dataSource.pageSize!=undefined){m.dataSource.pageSize=q.dataSource.pageSize}m.dataSource.aggregate=a.dataSource.aggregate}for(var g=0;g<m.columns.length;g++){var n=m.columns[g];var o=NutcacheGridFunctions.ParseFieldName(n.field);for(var h=0;h<q.columns.length;h++){var p=q.columns[h];if(NutcacheGridFunctions.ParseFieldName(p.field)==o){if(p.hidden!=undefined){n.hidden=p.hidden;if(!p.hidden){if(n.attributes==undefined){n.attributes={}}n.attributes.style="";if(n.headerAttributes==undefined){n.headerAttributes={}}n.headerAttributes.style="";if(n.footerAttributes==undefined){n.footerAttributes={}}n.footerAttributes.style=""}}if(p.locked!=undefined){n.locked=p.locked}if(p.width!=undefined){n.width=p.width}n.savedPosition=q.columns.indexOf(p);break}}if(n.savedPosition==undefined){n.savedPosition=99999}}m.dataSource.sort=q.dataSource.sort!=undefined?q.dataSource.sort.filter(function(i){return m.columns.some(function(j){return NutcacheGridFunctions.ParseFieldName(j.field)==NutcacheGridFunctions.ParseFieldName(i.field)})}):q.dataSource.sort;m.dataSource.group=q.dataSource.group!=undefined?q.dataSource.group.filter(function(i){return m.columns.some(function(j){return NutcacheGridFunctions.ParseFieldName(j.field)==NutcacheGridFunctions.ParseFieldName(i.field)})}):q.dataSource.group;if(m.dataSource.group!=undefined){for(var g=0;g<m.dataSource.group.length;g++){var e=m.dataSource.group[g];e.aggregates=m.dataSource.aggregate!=undefined?m.dataSource.aggregate.filter(function(i){return m.columns.some(function(j){return NutcacheGridFunctions.ParseFieldName(j.field)==NutcacheGridFunctions.ParseFieldName(i.field)})}):m.dataSource.aggregate}}if(q.dataSource.filter!=undefined){f=false;NutcacheGridFunctions.cleanSavedFiltersRecursive(q.dataSource.filter,m,q);m.dataSource.filter=q.dataSource.filter}m.columns.sort(function(i,j){return i.savedPosition-j.savedPosition});for(var l=0;l<m.columns.length;l++){delete m.columns[l].savedPosition}d.setOptions(m);$(b).find(".k-grid-toolbar").html(s)}f?$(c+" .k-filter-row").hide():$(c+" .nutcache-action-search").addClass("clicked");if(!$(c+" .k-header.actions-column .k-header-column-menu").length){$(c+" .k-header.actions-column").append($(c+" .k-header-column-menu").first())}$(c+" .k-header.actions-column .k-link").remove();$(c+" .k-grid-header .k-header:not(.actions-column) .k-header-column-menu").remove();d.dataSource.read()},cleanSavedFiltersRecursive:function(b,d,e){if(b.filters){for(var c=0;c<b.filters.length;){var a=b.filters[c];if(!NutcacheGridFunctions.cleanSavedFiltersRecursive(a,d,e)){b.filters.splice(c,1)}else{c++}}return b.filters.length>0}return d.columns.some(function(f){return NutcacheGridFunctions.ParseFieldName(f.field)==NutcacheGridFunctions.ParseFieldName(b.field)})},reloadConfig:function(a){var b=$(a).data("kendoGrid");NutcacheGridFunctions.loadConfig(a);b.dataSource.read()},ParseFieldName:function(c){var a=new RegExp("_[a-z]{2,3}[A-Z]{2,3}");var b=a.exec(c);if(b==null){return c}else{return c.substring(0,c.length-b[0].length)}},menuActionResetConfig:function(a){NutcacheGridFunctions.resetConfig("#"+a.config.elementName)},resetConfig:function(a){Nutcache.Waitingwindow.Show();localStorage.removeItem(a+"-options");location.reload()},refreshGrids:function(a){if(typeof a=="string"&&a.length>0){$(a).each(function(b){$(this).data("kendoGrid").dataSource.read();$(this).data("kendoGrid").refresh()})}},setNoDataMinHeight:function(b,a){var e=b.dataSource.total();var c=b.element.find(".grid-no-data");if(!c.length){var d=b.element.find(".k-grid-pager");if(d.length>0){c=$(".grid-no-data.master").clone();c.removeClass("master");c.insertBefore(d);if(b.element[0].id=="gridSubscriptionInvoices"||a){b.element.find(".click-to-add").hide()}}}if(e==0){b.element.addClass("nc-grid-nodata")}else{b.element.removeClass("nc-grid-nodata")}},autoSelectInputText:function(a){setTimeout(function(){var b=$("input[type=text]:visible",a);if(b.length){b.select()}},25)},dropDownList_OpenOnDataBound:function(a){this.open()},autoComplete_OpenOnDataBound:function(a){if(this.dataSource.data().length){this.open()}},getModelPropertyList:function(d,c,a){var b="";if(d!=null){$.each(d.dataItems(),function(e,f){b+=a(f)+","})}if(c!=null){$.each(c.dataItems(),function(e,f){b+=a(f)+","})}if(b.length){b=b.substring(0,b.length-1)}return b},menuActionExportToExcel:function(a){var b=$("#"+a.config.elementName).data("kendoGrid");b.saveAsExcel()},menuActionExportToPdf:function(a){var b=$("#"+a.config.elementName).data("kendoGrid");b.saveAsPDF()},clickSearchButton:function(b){var a=$("#"+b).data("kendoGrid");if($("#"+b+" .k-filter-row").css("display")=="none"){$("#"+b+" .k-filter-row").show();$("#"+b+" .nutcache-action-search").addClass("clicked")}else{$("#"+b+" .k-filter-row").hide();a.dataSource.filter({});$("#"+b+" .nutcache-action-search").removeClass("clicked")}}};