var InvoiceEmailFunctions={popupInvoiceSendEmailWindowForInvoice:function(b,c,d,a){if(b>0){PopupWindowGet(b,"Invoice",d,a,{id:b,invoiceVersion:c},"GetSendEmailToView")}},popupInvoiceSendReminderEmailWindowForInvoice:function(b,c,d,a){if(b>0){PopupWindowGet(b,"Invoice",d,a,{id:b,invoiceVersion:c},"GetSendReminderEmailToView")}},sendInvoiceSuccess:function(a){if(!a.IsSaved&&a.IsRedirect){Nutcache.Messages.handleAjaxErrors(a)}else{if(a.IsSaved){ClosePopupWindow();NutcacheGridFunctions.refreshGrids("#gridInvoices,#gridInvoiceOverdue");Nutcache.Messages.displayMessageHtml(a.Messages)}}},sendEmailFromEditSuccess:function(a){if(!a.IsSaved&&a.IsRedirect){Nutcache.Messages.handleAjaxErrors(a)}else{if(a.IsSaved){ClosePopupWindow();InvoiceFunctions.refreshInvoice();Nutcache.Messages.displayMessageHtml(a.Messages)}}}};function InvoiceEmail_InitializeTokenField(){$("#PrimaryRecipients,#SecondaryRecipients").tokenField()}function Invoice_GetEmailData(){var c=$("#popup-window #InvoiceId").val();var d=$("#popup-window #InvoiceVersion").val();var b=$("#popup-window #InvoiceAction").val();var a={InvoiceId:c,InvoiceVersion:d,InvoiceAction:b,PrimaryRecipients:$('[name="PrimaryRecipients"]').val(),SecondaryRecipients:$('[name="SecondaryRecipients"]').val(),Subject:$("#popup-window  #Subject").val(),Message:$("#popup-window  #Message").val(),SenderCopy:$("#SenderCopy").is(":checked"),SenderType:$("#popup-window  #SenderType").val(),SenderUserProfileId:$("#popup-window  #SenderUserProfileId").val()};return a}function SendInvoiceEmailFromInvoice(b){Nutcache.Waitingwindow.Show();var a=Invoice_GetEmailData();var c=InvoiceFunctions.getInvoiceUrl()+"SendInvoice";Nutcache.Ajax.TryAjaxCall({url:c,contentType:"application/json; charset=utf-8",type:"POST",data:JSON.stringify(a),dataType:"json",success:function(d){Nutcache.Waitingwindow.Close();if(b){b(d)}},error:ManageAjaxError})}function SendInvoiceReminderEmailFromInvoice(b){Nutcache.Waitingwindow.Show();var a=Invoice_GetEmailData();var c=InvoiceFunctions.getInvoiceUrl()+"SendInvoiceOverdueReminder";Nutcache.Ajax.TryAjaxCall({url:c,contentType:"application/json; charset=utf-8",type:"POST",data:JSON.stringify(a),dataType:"json",success:function(d){Nutcache.Waitingwindow.Close();if(b){b(d)}},error:ManageAjaxError})};