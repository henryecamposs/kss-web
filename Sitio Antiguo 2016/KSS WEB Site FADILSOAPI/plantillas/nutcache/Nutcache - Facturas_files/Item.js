var ItemFunctions={getUrl:function(b){var a=b==0?"Product":"Service";return GetUrl(a)},actionEdit:function(a){ItemPopupFunctions.showPopupWindow(a.recordId,a.config.itemType,function(){NutcacheGridFunctions.refreshGrids("#"+a.config.gridName)})},actionDelete:function(a){OpenDeleteDialogWindow(a.menuData.messages.deleteConfirmTitle,a.menuData.messages.deleteConfirmMessage,function(){ItemFunctions.deleteItem(a.recordId,a.config.itemType,function(){NutcacheGridFunctions.refreshGrids("#"+a.config.gridName)})})},deleteItem:function(a,b,c){Nutcache.Ajax.TryAjaxCall({url:ItemFunctions.getUrl(b)+"Delete",contentType:"application/x-www-form-urlencoded; charset=UTF-8",type:"GET",dataType:"json",data:{id:a},success:function(d){if(d.IsSaved){if(c){c(d)}}LoadMessagesSection(d.Messages,"#floating-message-window")},error:ManageAjaxError})}};var ItemPopupFunctions={showPopupWindow:function(b,c,g,a,f){var h=ItemFunctions.getUrl(c)+"GetView?"+$.param({id:b,projectId:f});var d=c==0?"ProductEditPopup":"TaskEditPopup";var e=PopupWindowFunctions.getPopupWindow(d,"ID",b);if(e!=null){PopupWindowFunctions.refreshPopupWindowContent(e,h,function(){ItemPopupFunctions.setSuccessJsCallbackFunction(e.wrapper,g)})}else{PopupWindowFunctions.openPopupWindow(h,function(i){ItemPopupFunctions.save(i,c,g)},a,function(i){ItemPopupFunctions.setSuccessJsCallbackFunction(i.wrapper,g)})}},setSuccessJsCallbackFunction:function(a,b){$("#SuccessJsCallbackFunction",a).val(String(b).replace(/"/g,"'"))},save:function(d,c,e){var b=ItemPopupFunctions.getData(d.wrapper,c);var a=(typeof b.Id=="undefined"||b.Id=="0"?"Create":"Edit");Nutcache.Ajax.TryAjaxCall({url:ItemFunctions.getUrl(c)+a,contentType:"application/json; charset=utf-8",type:"POST",data:JSON.stringify(b),dataType:"json",success:function(f){ItemPopupFunctions.saveSuccess(d,f,c,e)},error:ManageAjaxError});return false},saveSuccess:function(c,a,b,d){if(!a.IsSaved&&a.IsRedirect){Nutcache.Messages.handleAjaxErrors(a)}else{if(a.IsSaved){c.close();if(d){d(a.Content)}Nutcache.Messages.displayMessageHtml(a.Messages)}}},getData:function(a,c){var b={Id:$("#ID",a).val(),Code:$("#Code",a).val(),Description:$("#Description",a).val(),Type:c,UnitRate:$("#UnitRate",a).val(),TaxId:$("#Tax_ID",a).val(),Status:$("#ItemStatus",a).val(),Version:$("#Version",a).val(),ProjectIdToAssign:$("#ProjectIdToAssign",a).val(),AutoAssignToProject:$("#AutoAssignToProject",a).is(":checked"),SuccessJsCallbackFunction:$("#SuccessJsCallbackFunction",a).val()};return b},getInformations:function(a,b,c){if(a==null){a=0}Nutcache.Ajax.TryAjaxCall({url:ItemFunctions.getUrl(b)+"GetItem",contentType:"application/x-www-form-urlencoded; charset=UTF-8",type:"POST",data:{itemId:a},dataType:"json",success:function(d){if(c){c(d.Content)}},error:ManageAjaxError})}};function ProductsIndexGrid_OnRecordSelected(b,a){ItemPopupFunctions.showPopupWindow(b.ID,b.Type,function(){NutcacheGridFunctions.refreshGrids("#gridProducts")},null,null)}function ServicesIndexGrid_OnRecordSelected(b,a){ItemPopupFunctions.showPopupWindow(b.ID,b.Type,function(){NutcacheGridFunctions.refreshGrids("#gridServices")},null,null)};